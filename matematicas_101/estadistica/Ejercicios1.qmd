---
title: "Ejercicios1"
format: html
editor: visual
---

## Peso al nacer

Leer el dataset que se encuentra en data/birthweight_reduced.csv.

bwt \<- read.csv("./data/birthweight_reduced.csv")

head(bwt)

```{r}
bwt <- read.csv("./data/birthweight_reduced.csv")
head(bwt)
```

Convertir la columna smoker en un factor con los valores: 1- 'YES' 0- 'NO'

```{r}
bwt$smoker <- factor(bwt$smoker, levels = c(0, 1), labels = c("NO", "YES"))
head(bwt)
```

Para la columna Birthweight:

1- Calcular media, mediana y los cuartiles

```{r}
mean_birthweight <- mean(bwt$Birthweight, na.rm = TRUE)
median_birthweight <- median(bwt$Birthweight, na.rm = TRUE)
quantile_birthweight <- quantile(bwt$Birthweight, na.rm = TRUE)


print(paste("mean_birthweight: ", mean_birthweight))
print(paste("median_birthweight: ", median_birthweight))
print(paste("quantile_birthweight: ", quantile_birthweight))
```

2- Dibujar un Boxplot. Y decir cuales son los outliers, y ver si veis alguna caracteristica importante.

```{r}
# Dibujar boxplot de Birthweight
bx <- boxplot(bwt$Birthweight, 
        main = "Boxplot de Birthweight",
        ylab = "Birthweight")

bx$out # No hay outliers
```

3-¿Cuantas madres fumadoras y no fumadoras hay?

```{r}
library('tidyverse')
bwt |> 
   group_by(smoker) |> 
   summarise(num_mothers = n())
```

4- ¿Cual es el peso medio de los niños al nacer para las madres fumadoras y no fumadoras?

```{r}

bwt |> 
   group_by(smoker) |> 
   summarise(mean_birthweight = mean(Birthweight, na.rm = TRUE))
```

5- ¿Cual de los dos grupos presenta una varianza mayor?

```{r}
bwt |> 
   group_by(smoker) |> 
   summarise(var_birthweight = var(Birthweight, na.rm = TRUE))
```

6- Pinta un Boxplot del peso para cada uno de los grupos

```{r}
boxplot(Birthweight ~ smoker, data = bwt,
        main = "Boxplot de peso al nacer por grupo de fumadoras",
        xlab = "Madre fumadora",
        ylab = "Peso al nacer")
```

## Ciudades soleadas

Vamos a leer el dataset cities_sunny. Muestra las horas de sol medias que tienen diferentes ciudades en un mes determinado.

```{r}
df_sunny <- read.csv("./data/cities_sunny.csv")
head(df_sunny)
```

1- ¿Cuantos paises hay? ¿Cuantas Ciudades?

```{r}
library(dplyr)
num_paises <- df_sunny |> 
   group_by(Country) |> 
   summarise() |> 
   nrow()
paste("Número Paises: ", num_paises)

num_ciudades <- df_sunny |> 
   group_by(City) |> 
   summarise() |> 
   nrow()
paste("Número Ciudades: ", num_ciudades)
```

Numero de ciudades por pais. Hay tantas filas como paises:

```{r}
um_ciudades_por_pais <- df_sunny |> 
   group_by(Country) |> 
   summarise(ciudades = n_distinct(City))

print(um_ciudades_por_pais)
```

Numero de ciudades:

```{r}

```

2- ¿Cual es la ciudad que más horas de sol tiene en enero?

```{r}
library(dplyr)
max_sunny_jan <- df_sunny |> 
   slice_max(order_by = Jan, n = 1) |> 
   select(City, Jan)

print(max_sunny_jan)
```

3- ¿Cual es la ciudad que más horas de sol totales tiene en los meses de Enero, Febrero y Marzo? (suma los 3 meses y encuentra la ciudad con el máximo)

```{r}

max_trimestre <- df_sunny %>%
  mutate(total_enero_marzo = Jan + Feb + Mar) |>
  slice_max(order_by = total_enero_marzo, n = 1) |>
  select(City, total_enero_marzo)

print(max_trimestre)
```

4- ¿Cual es la ciudad que más horas de sol tiene en todo el año? (sumando todos los meses)

```{r}
library(dplyr)
max_anual <- df_sunny %>% mutate(total_anual = rowSums(select(., Jan:Dec))) |> 
   slice_max(order_by = total_anual, n = 1) |> 
   select(City, total_anual)

print(max_anual)
```

5- En el dataset, ¿cual es el país que tiene más ciudades?. Muestra el número medio de horas mensuales en enero para las ciudades de ese país.

```{r}
df_sunny |> 
   group_by(Country) |> 
   summarise(count = n(), mean_january = mean(Jan)) |>
   arrange(desc(count)) |>
   slice(1)

```

6- ¿Cual es el número medio de horas soleadas al mes en Madrid? ¿y su mediana?

```{r}
madrid <- df_sunny |>
  filter(City == "Madrid") |>
  select(Jan:Dec)

mean_madrid <- madrid |> unlist() |> mean(na.rm = TRUE)
median_madrid <- madrid |> unlist() |> median(na.rm = TRUE)

paste("Media de horas soleadas al mes en Madrid:", mean_madrid)
paste("Mediana de horas soleadas al mes en Madrid:", median_madrid)
```
